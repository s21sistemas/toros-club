import{o as f,h as m,e as d,i as b,u as h,k as D,d as w,f as E,t as n}from"./index-CjWeqAa0.js";import{u as c}from"./InputField-C2bV7C3J.js";const y=w(d,"modulos"),R=async a=>{try{const r={label:a.nombre,value:a.nombre.toLowerCase()};return(await D(y,r)).id}catch(r){console.error("Error al agregar módulo:",r)}},S=async a=>f(y,r=>{const e=r.docs.map(t=>({id:t.id,...t.data(),nombre:t.data().label}));a(e)}),C=async(a,r)=>{try{const e={label:r.nombre,value:r.nombre.toLowerCase()},t=m(d,"modulos",a);delete r.nombre,await h(t,e)}catch(e){console.error("Error al actualizar módulo:",e)}},v=async a=>{try{const r=m(d,"modulos",a);await b(r)}catch(r){console.error("Error al eliminar módulo:",r)}};let u=null;const s=E((a,r)=>({modules:[],loading:!1,getDataModules:async()=>(a({loading:!0}),new Promise((e,t)=>{try{u?e(r().modules):u=S(l=>{a({modules:l}),e(l)})}catch(l){console.error(l),t(l)}finally{a({loading:!1})}})),addModule:async e=>{const t=async()=>{try{await R(e)}catch(l){console.error(l)}};n.promise(t(),{loading:"Creando registro...",success:"Registro creado correctamente",error:"Falló al crear el registro."})},editModule:async e=>{const t=async()=>{try{await C(e.id,e)}catch(l){console.error(l)}};n.promise(t(),{loading:"Actualizando...",success:"Actualizado correctamente",error:"Falló al eliminar."})},deleteModule:async e=>{const t=async()=>{try{await v(e)}catch(l){console.error(l)}};n.promise(t(),{loading:"Eliminando...",success:"Eliminado correctamente",error:"Falló al eliminar."})}})),T=()=>{const a=c(o=>o.modalType),r=c(o=>o.formData),e=c(o=>o.closeModal),t=s(o=>o.loading),l=s(o=>o.modules),i=s(o=>o.getDataModules),M=s(o=>o.addModule),g=s(o=>o.editModule),p=s(o=>o.deleteModule);return{modules:l,loading:t,getDataModules:i,handleSubmit:o=>{o.preventDefault(),a==="add"?M(r):a==="edit"&&g(r),e()},handleDelete:o=>{p(o),e()},loadOptions:async()=>{try{return await i()}catch(o){return console.error("Error loading modules:",o),[]}}}};export{T as u};
