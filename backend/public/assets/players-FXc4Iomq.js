import{h as i,e as c,u as I,T as $,k as h,d,o as Y,i as q,t as N,n as P,q as T,w as R,p as C}from"./index-CjWeqAa0.js";import{d as E}from"./dayjs.min-DH9acFiI.js";import{f as v}from"./costos-porrista-9QLCd6eY.js";const w=d(c,"jugadores"),B=d(c,"pagos_jugadores"),k=async e=>{try{const a={...e,fecha_registro:$.now()},o=(await h(w,a)).id,n=`${e.nombre} ${e.apellido_p} ${e.apellido_m}`,r=e.temporadaId,s=e.categoria;return await F(o,n,r,s),o}catch(a){console.error("Error al agregar jugador:",a)}},x=async e=>Y(w,async a=>{const t=await Promise.all(a.docs.map(async o=>{const n=await D(o.data().uid),r=`${o.data().nombre} ${o.data().apellido_p} ${o.data().apellido_m}`;return{...o.data(),id:o.id,nombre_completo:r,uid:{value:o.data().uid,label:n==null?void 0:n.nombre_completo}}}));e(t)}),J=async e=>{try{const a=i(c,"jugadores",e),t=await P(a);if(t.exists()){const o=t.data(),n=await D(o.uid),r=`${o.nombre} ${o.apellido_p} ${o.apellido_m}`;return{...o,id:t.id,nombre_completo:r,uid:{value:o.uid,label:n==null?void 0:n.nombre_completo}}}else return console.warn("No se encontró el jugador con ese ID"),null}catch(a){return console.error("Error al obtener el jugador:",a),null}},U=async(e,a)=>{try{const t=i(c,"jugadores",e);await I(t,a)}catch(t){console.error("Error al actualizar jugador:",t)}},z=async e=>{try{const a=i(c,"jugadores",e);await q(a)}catch(a){console.error("Error al eliminar jugador:",a)}},D=async e=>{try{const a=d(c,"usuarios"),t=T(a,R("uid","==",e)),o=await C(t);return o.empty?(console.log("No se encontró un usuario con ese ID."),null):o.docs[0].data()}catch(a){return console.error("Error buscando usuario:",a),null}},F=async(e,a,t,o)=>{var b,_,y,f;const n=E(),r=n.add(1,"week").format("YYYY/MM/DD"),s=await v(t);s.length===0&&N.warning("No se encontraron costos para esta temporada. Se usarán valores por defecto.");const l=parseFloat((b=s[0])==null?void 0:b.inscripcion)||500,u=parseFloat((_=s[0])==null?void 0:_.coaching)||500,p=parseFloat((y=s[0])==null?void 0:y.tunel)||500,m=parseFloat((f=s[0])==null?void 0:f.botiquin)||500,g=l+u+p+m,j={jugadorId:e,nombre:a,temporadaId:t,categoria:o,pagos:[{tipo:"Inscripción",beca:"0",descuento:"0",estatus:"pendiente",fecha_pago:null,submonto:l,monto:l,prorroga:!1,fecha_limite:r,metodo_pago:null,abono:"NO",abonos:[],total_abonado:0},{tipo:"Coaching",estatus:"pendiente",fecha_pago:null,fecha_limite:null,monto:u,metodo_pago:null,abono:"NO",abonos:[],total_abonado:0},{tipo:"Túnel",estatus:"pendiente",fecha_pago:null,monto:p,metodo_pago:null,abono:"NO",abonos:[],total_abonado:0},{tipo:"Botiquín",estatus:"pendiente",fecha_pago:null,monto:m,metodo_pago:null,abono:"NO",abonos:[],total_abonado:0}],monto_total_pagado:0,monto_total_pendiente:g,monto_total:g,fecha_registro:n.format("YYYY-MM-DD")};await h(B,j)};export{J as a,k as c,x as g,z as r,U as u};
