import{h as m,e as n,u as C,T as _,k as h,d as g,o as b,i as w,t as u,f as D}from"./index-CjWeqAa0.js";import{d as I}from"./dayjs.min-DH9acFiI.js";import{o as E}from"./costos-porrista-9QLCd6eY.js";const f=g(n,"porristas"),T=g(n,"pagos_porristas"),R=async e=>{try{const r={...e,fecha_registro:_.now()},a=(await h(f,r)).id,t=`${e.nombre} ${e.apellido_p} ${e.apellido_m}`,s=e.temporadaId;return await P(a,t,s),a}catch(r){console.error("Error al agregar porrista:",r)}},Y=async e=>b(f,r=>{const o=r.docs.map(a=>({id:a.id,foto:a.data().foto_jugador,...a.data()}));e(o)}),F=async(e,r)=>{try{const o=m(n,"porristas",e);await C(o,r)}catch(o){console.error("Error al actualizar porrista:",o)}},N=async e=>{try{const r=m(n,"porristas",e);await w(r)}catch(r){console.error("Error al eliminar porrista:",r)}},P=async(e,r,o)=>{var i,d;const a=I(),t=await E(o);t.length===0&&u.warning("No se encontraron costos para esta temporada. Se usarán valores por defecto.");const s=parseFloat((i=t[0])==null?void 0:i.inscripcion)||500,c=parseFloat((d=t[0])==null?void 0:d.coaching)||500,l=s+c,y={porristaId:e,nombre:r,pagos:[{tipo:"Inscripción",estatus:"pendiente",fecha_pago:null,monto:s,metodo_pago:null,abono:"NO",abonos:[],total_abonado:0},{tipo:"Coaching",estatus:"pendiente",fecha_pago:null,monto:c,metodo_pago:null,abono:"NO",abonos:[],total_abonado:0}],monto_total_pagado:0,monto_total_pendiente:l,monto_total:l,fecha_registro:a.format("YYYY-MM-DD")};await h(T,y)};let p=null;const M=D((e,r)=>({cheerleader:[],cheerleadersCount:0,loading:!1,getDataCheerleaders:async()=>(e({loading:!0}),new Promise((o,a)=>{try{p?o(r().cheerleader):p=Y(t=>{e({cheerleader:t,cheerleadersCount:t.length}),o(t)})}catch(t){console.error(t),a(t)}finally{e({loading:!1})}})),addCheerleader:async o=>{try{await R(o)}catch(a){console.error(a)}},editCheerleader:async o=>{try{await F(o.id,o)}catch(a){console.error(a)}},deleteCheerleader:async o=>{const a=async()=>{try{await N(o)}catch(t){console.error(t)}};u.promise(a(),{loading:"Eliminando...",success:"Eliminado correctamente",error:"Falló al eliminar."})}}));export{M as u};
