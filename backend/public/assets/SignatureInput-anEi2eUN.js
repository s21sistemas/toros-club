import{c as k,g as L,R as z,r as R,t as N,j as x}from"./index-BBEn_SVL.js";import{_ as W,b as D,c as U,d as j,e as A,f as B,u as O}from"./InputField-be6TBco1.js";import{P as y}from"./index-CzTdLKZX.js";import{S as q}from"./uploadFile-Cfp7ffx4.js";/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=[["path",{d:"M12.5 22H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v9.5",key:"1couwa"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M13.378 15.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"1y4qbx"}]],$=k("FilePen",I);/**
 * @license lucide-react v0.483.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],H=k("SquareX",V);/*!
 * Signature Pad v2.3.2
 * https://github.com/szimek/signature_pad
 *
 * Copyright 2017 Szymon Nowak
 * Released under the MIT license
 *
 * The main idea and some parts of the code (e.g. drawing variable width Bézier curve) are taken from:
 * http://corner.squareup.com/2012/07/smoother-signatures.html
 *
 * Implementation of interpolation using cubic Bézier curves is taken from:
 * http://benknowscode.wordpress.com/2012/09/14/path-interpolation-using-cubic-bezier-and-control-point-estimation-in-javascript
 *
 * Algorithm for approximated length of a Bézier curve is taken from:
 * http://www.lemoda.net/maths/bezier-length/index.html
 *
 */function C(e,n,i){this.x=e,this.y=n,this.time=i||new Date().getTime()}C.prototype.velocityFrom=function(e){return this.time!==e.time?this.distanceTo(e)/(this.time-e.time):1};C.prototype.distanceTo=function(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))};C.prototype.equals=function(e){return this.x===e.x&&this.y===e.y&&this.time===e.time};function M(e,n,i,t){this.startPoint=e,this.control1=n,this.control2=i,this.endPoint=t}M.prototype.length=function(){for(var e=10,n=0,i=void 0,t=void 0,r=0;r<=e;r+=1){var a=r/e,s=this._point(a,this.startPoint.x,this.control1.x,this.control2.x,this.endPoint.x),o=this._point(a,this.startPoint.y,this.control1.y,this.control2.y,this.endPoint.y);if(r>0){var c=s-i,h=o-t;n+=Math.sqrt(c*c+h*h)}i=s,t=o}return n};M.prototype._point=function(e,n,i,t,r){return n*(1-e)*(1-e)*(1-e)+3*i*(1-e)*(1-e)*e+3*t*(1-e)*e*e+r*e*e*e};function X(e,n,i){var t,r,a,s=null,o=0;i||(i={});var c=function(){o=i.leading===!1?0:Date.now(),s=null,a=e.apply(t,r),s||(t=r=null)};return function(){var h=Date.now();!o&&i.leading===!1&&(o=h);var l=n-(h-o);return t=this,r=arguments,l<=0||l>n?(s&&(clearTimeout(s),s=null),o=h,a=e.apply(t,r),s||(t=r=null)):!s&&i.trailing!==!1&&(s=setTimeout(c,l)),a}}function v(e,n){var i=this,t=n||{};this.velocityFilterWeight=t.velocityFilterWeight||.7,this.minWidth=t.minWidth||.5,this.maxWidth=t.maxWidth||2.5,this.throttle="throttle"in t?t.throttle:16,this.minDistance="minDistance"in t?t.minDistance:5,this.throttle?this._strokeMoveUpdate=X(v.prototype._strokeUpdate,this.throttle):this._strokeMoveUpdate=v.prototype._strokeUpdate,this.dotSize=t.dotSize||function(){return(this.minWidth+this.maxWidth)/2},this.penColor=t.penColor||"black",this.backgroundColor=t.backgroundColor||"rgba(0,0,0,0)",this.onBegin=t.onBegin,this.onEnd=t.onEnd,this._canvas=e,this._ctx=e.getContext("2d"),this.clear(),this._handleMouseDown=function(r){r.which===1&&(i._mouseButtonDown=!0,i._strokeBegin(r))},this._handleMouseMove=function(r){i._mouseButtonDown&&i._strokeMoveUpdate(r)},this._handleMouseUp=function(r){r.which===1&&i._mouseButtonDown&&(i._mouseButtonDown=!1,i._strokeEnd(r))},this._handleTouchStart=function(r){if(r.targetTouches.length===1){var a=r.changedTouches[0];i._strokeBegin(a)}},this._handleTouchMove=function(r){r.preventDefault();var a=r.targetTouches[0];i._strokeMoveUpdate(a)},this._handleTouchEnd=function(r){var a=r.target===i._canvas;a&&(r.preventDefault(),i._strokeEnd(r))},this.on()}v.prototype.clear=function(){var e=this._ctx,n=this._canvas;e.fillStyle=this.backgroundColor,e.clearRect(0,0,n.width,n.height),e.fillRect(0,0,n.width,n.height),this._data=[],this._reset(),this._isEmpty=!0};v.prototype.fromDataURL=function(e){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=new Image,r=i.ratio||window.devicePixelRatio||1,a=i.width||this._canvas.width/r,s=i.height||this._canvas.height/r;this._reset(),t.src=e,t.onload=function(){n._ctx.drawImage(t,0,0,a,s)},this._isEmpty=!1};v.prototype.toDataURL=function(e){var n;switch(e){case"image/svg+xml":return this._toSVG();default:for(var i=arguments.length,t=Array(i>1?i-1:0),r=1;r<i;r++)t[r-1]=arguments[r];return(n=this._canvas).toDataURL.apply(n,[e].concat(t))}};v.prototype.on=function(){this._handleMouseEvents(),this._handleTouchEvents()};v.prototype.off=function(){this._canvas.removeEventListener("mousedown",this._handleMouseDown),this._canvas.removeEventListener("mousemove",this._handleMouseMove),document.removeEventListener("mouseup",this._handleMouseUp),this._canvas.removeEventListener("touchstart",this._handleTouchStart),this._canvas.removeEventListener("touchmove",this._handleTouchMove),this._canvas.removeEventListener("touchend",this._handleTouchEnd)};v.prototype.isEmpty=function(){return this._isEmpty};v.prototype._strokeBegin=function(e){this._data.push([]),this._reset(),this._strokeUpdate(e),typeof this.onBegin=="function"&&this.onBegin(e)};v.prototype._strokeUpdate=function(e){var n=e.clientX,i=e.clientY,t=this._createPoint(n,i),r=this._data[this._data.length-1],a=r&&r[r.length-1],s=a&&t.distanceTo(a)<this.minDistance;if(!(a&&s)){var o=this._addPoint(t),c=o.curve,h=o.widths;c&&h&&this._drawCurve(c,h.start,h.end),this._data[this._data.length-1].push({x:t.x,y:t.y,time:t.time,color:this.penColor})}};v.prototype._strokeEnd=function(e){var n=this.points.length>2,i=this.points[0];if(!n&&i&&this._drawDot(i),i){var t=this._data[this._data.length-1],r=t[t.length-1];i.equals(r)||t.push({x:i.x,y:i.y,time:i.time,color:this.penColor})}typeof this.onEnd=="function"&&this.onEnd(e)};v.prototype._handleMouseEvents=function(){this._mouseButtonDown=!1,this._canvas.addEventListener("mousedown",this._handleMouseDown),this._canvas.addEventListener("mousemove",this._handleMouseMove),document.addEventListener("mouseup",this._handleMouseUp)};v.prototype._handleTouchEvents=function(){this._canvas.style.msTouchAction="none",this._canvas.style.touchAction="none",this._canvas.addEventListener("touchstart",this._handleTouchStart),this._canvas.addEventListener("touchmove",this._handleTouchMove),this._canvas.addEventListener("touchend",this._handleTouchEnd)};v.prototype._reset=function(){this.points=[],this._lastVelocity=0,this._lastWidth=(this.minWidth+this.maxWidth)/2,this._ctx.fillStyle=this.penColor};v.prototype._createPoint=function(e,n,i){var t=this._canvas.getBoundingClientRect();return new C(e-t.left,n-t.top,i||new Date().getTime())};v.prototype._addPoint=function(e){var n=this.points,i=void 0;if(n.push(e),n.length>2){n.length===3&&n.unshift(n[0]),i=this._calculateCurveControlPoints(n[0],n[1],n[2]);var t=i.c2;i=this._calculateCurveControlPoints(n[1],n[2],n[3]);var r=i.c1,a=new M(n[1],t,r,n[2]),s=this._calculateCurveWidths(a);return n.shift(),{curve:a,widths:s}}return{}};v.prototype._calculateCurveControlPoints=function(e,n,i){var t=e.x-n.x,r=e.y-n.y,a=n.x-i.x,s=n.y-i.y,o={x:(e.x+n.x)/2,y:(e.y+n.y)/2},c={x:(n.x+i.x)/2,y:(n.y+i.y)/2},h=Math.sqrt(t*t+r*r),l=Math.sqrt(a*a+s*s),u=o.x-c.x,d=o.y-c.y,p=l/(h+l),m={x:c.x+u*p,y:c.y+d*p},f=n.x-m.x,_=n.y-m.y;return{c1:new C(o.x+f,o.y+_),c2:new C(c.x+f,c.y+_)}};v.prototype._calculateCurveWidths=function(e){var n=e.startPoint,i=e.endPoint,t={start:null,end:null},r=this.velocityFilterWeight*i.velocityFrom(n)+(1-this.velocityFilterWeight)*this._lastVelocity,a=this._strokeWidth(r);return t.start=this._lastWidth,t.end=a,this._lastVelocity=r,this._lastWidth=a,t};v.prototype._strokeWidth=function(e){return Math.max(this.maxWidth/(e+1),this.minWidth)};v.prototype._drawPoint=function(e,n,i){var t=this._ctx;t.moveTo(e,n),t.arc(e,n,i,0,2*Math.PI,!1),this._isEmpty=!1};v.prototype._drawCurve=function(e,n,i){var t=this._ctx,r=i-n,a=Math.floor(e.length());t.beginPath();for(var s=0;s<a;s+=1){var o=s/a,c=o*o,h=c*o,l=1-o,u=l*l,d=u*l,p=d*e.startPoint.x;p+=3*u*o*e.control1.x,p+=3*l*c*e.control2.x,p+=h*e.endPoint.x;var m=d*e.startPoint.y;m+=3*u*o*e.control1.y,m+=3*l*c*e.control2.y,m+=h*e.endPoint.y;var f=n+h*r;this._drawPoint(p,m,f)}t.closePath(),t.fill()};v.prototype._drawDot=function(e){var n=this._ctx,i=typeof this.dotSize=="function"?this.dotSize():this.dotSize;n.beginPath(),this._drawPoint(e.x,e.y,i),n.closePath(),n.fill()};v.prototype._fromData=function(e,n,i){for(var t=0;t<e.length;t+=1){var r=e[t];if(r.length>1)for(var a=0;a<r.length;a+=1){var s=r[a],o=new C(s.x,s.y,s.time),c=s.color;if(a===0)this.penColor=c,this._reset(),this._addPoint(o);else if(a!==r.length-1){var h=this._addPoint(o),l=h.curve,u=h.widths;l&&u&&n(l,u,c)}}else{this._reset();var d=r[0];i(d)}}};v.prototype._toSVG=function(){var e=this,n=this._data,i=this._canvas,t=Math.max(window.devicePixelRatio||1,1),r=0,a=0,s=i.width/t,o=i.height/t,c=document.createElementNS("http://www.w3.org/2000/svg","svg");c.setAttributeNS(null,"width",i.width),c.setAttributeNS(null,"height",i.height),this._fromData(n,function(g,w,b){var P=document.createElement("path");if(!isNaN(g.control1.x)&&!isNaN(g.control1.y)&&!isNaN(g.control2.x)&&!isNaN(g.control2.y)){var F="M "+g.startPoint.x.toFixed(3)+","+g.startPoint.y.toFixed(3)+" "+("C "+g.control1.x.toFixed(3)+","+g.control1.y.toFixed(3)+" ")+(g.control2.x.toFixed(3)+","+g.control2.y.toFixed(3)+" ")+(g.endPoint.x.toFixed(3)+","+g.endPoint.y.toFixed(3));P.setAttribute("d",F),P.setAttribute("stroke-width",(w.end*2.25).toFixed(3)),P.setAttribute("stroke",b),P.setAttribute("fill","none"),P.setAttribute("stroke-linecap","round"),c.appendChild(P)}},function(g){var w=document.createElement("circle"),b=typeof e.dotSize=="function"?e.dotSize():e.dotSize;w.setAttribute("r",b),w.setAttribute("cx",g.x),w.setAttribute("cy",g.y),w.setAttribute("fill",g.color),c.appendChild(w)});var h="data:image/svg+xml;base64,",l='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"'+(' viewBox="'+r+" "+a+" "+s+" "+o+'"')+(' width="'+s+'"')+(' height="'+o+'"')+">",u=c.innerHTML;if(u===void 0){var d=document.createElement("dummy"),p=c.childNodes;d.innerHTML="";for(var m=0;m<p.length;m+=1)d.appendChild(p[m].cloneNode(!0));u=d.innerHTML}var f="</svg>",_=l+u+f;return h+btoa(_)};v.prototype.fromData=function(e){var n=this;this.clear(),this._fromData(e,function(i,t){return n._drawCurve(i,t.start,t.end)},function(i){return n._drawDot(i)}),this._data=e};v.prototype.toData=function(){return this._data};var E={exports:{}},Y=E.exports,T;function G(){return T||(T=1,function(e,n){(function(i,t){e.exports=t()})(Y,function(){return function(i){function t(a){if(r[a])return r[a].exports;var s=r[a]={exports:{},id:a,loaded:!1};return i[a].call(s.exports,s,s.exports,t),s.loaded=!0,s.exports}var r={};return t.m=i,t.c=r,t.p="",t(0)}([function(i,t){function r(h){var l=h.getContext("2d"),u=h.width,d=h.height,p=l.getImageData(0,0,u,d).data,m=o(!0,u,d,p),f=o(!1,u,d,p),_=c(!0,u,d,p),g=c(!1,u,d,p),w=g-_+1,b=f-m+1,P=l.getImageData(_,m,w,b);return h.width=w,h.height=b,l.clearRect(0,0,w,b),l.putImageData(P,0,0),h}function a(h,l,u,d){return{red:d[4*(u*l+h)],green:d[4*(u*l+h)+1],blue:d[4*(u*l+h)+2],alpha:d[4*(u*l+h)+3]}}function s(h,l,u,d){return a(h,l,u,d).alpha}function o(h,l,u,d){for(var p=h?1:-1,m=h?0:u-1,f=m;h?f<u:f>-1;f+=p)for(var _=0;_<l;_++)if(s(_,f,l,d))return f;return null}function c(h,l,u,d){for(var p=h?1:-1,m=h?0:l-1,f=m;h?f<l:f>-1;f+=p)for(var _=0;_<u;_++)if(s(f,_,l,d))return f;return null}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r}])})}(E)),E.exports}var J=G();const K=L(J);var Q=["canvasProps","clearOnResize"],S=function(e){W(i,e);var n=D(i);function i(){var t;j(this,i);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return t=n.call.apply(n,[this].concat(a)),t.staticThis=t.constructor,t._sigPad=null,t._canvas=null,t.setRef=function(o){t._canvas=o,t._canvas===null&&(t._sigPad=null)},t._excludeOurProps=function(){var o=t.props;o.canvasProps,o.clearOnResize;var c=A(o,Q);return c},t.componentDidMount=function(){var o=t.getCanvas();t._sigPad=new v(o,t._excludeOurProps()),t._resizeCanvas(),t.on()},t.componentWillUnmount=function(){t.off()},t.componentDidUpdate=function(){Object.assign(t._sigPad,t._excludeOurProps())},t.getCanvas=function(){if(t._canvas===null)throw t.staticThis.refNullError;return t._canvas},t.getTrimmedCanvas=function(){var o=t.getCanvas(),c=document.createElement("canvas");return c.width=o.width,c.height=o.height,c.getContext("2d").drawImage(o,0,0),K(c)},t.getSignaturePad=function(){if(t._sigPad===null)throw t.staticThis.refNullError;return t._sigPad},t._checkClearOnResize=function(){t.props.clearOnResize&&t._resizeCanvas()},t._resizeCanvas=function(){var o,c,h=(o=t.props.canvasProps)!==null&&o!==void 0?o:{},l=h.width,u=h.height;if(!(typeof l<"u"&&typeof u<"u")){var d=t.getCanvas(),p=Math.max((c=window.devicePixelRatio)!==null&&c!==void 0?c:1,1);typeof l>"u"&&(d.width=d.offsetWidth*p),typeof u>"u"&&(d.height=d.offsetHeight*p),d.getContext("2d").scale(p,p),t.clear()}},t.render=function(){var o=t.props.canvasProps;return z.createElement("canvas",B({ref:t.setRef},o))},t.on=function(){return window.addEventListener("resize",t._checkClearOnResize),t.getSignaturePad().on()},t.off=function(){return window.removeEventListener("resize",t._checkClearOnResize),t.getSignaturePad().off()},t.clear=function(){return t.getSignaturePad().clear()},t.isEmpty=function(){return t.getSignaturePad().isEmpty()},t.fromDataURL=function(o,c){return t.getSignaturePad().fromDataURL(o,c)},t.toDataURL=function(o,c){return t.getSignaturePad().toDataURL(o,c)},t.fromData=function(o){return t.getSignaturePad().fromData(o)},t.toData=function(){return t.getSignaturePad().toData()},t}return U(i)}(R.Component);S.propTypes={velocityFilterWeight:y.number,minWidth:y.number,maxWidth:y.number,minDistance:y.number,dotSize:y.oneOfType([y.number,y.func]),penColor:y.string,throttle:y.number,onEnd:y.func,onBegin:y.func,canvasProps:y.object,clearOnResize:y.bool};S.defaultProps={clearOnResize:!0};S.refNullError=new Error("react-signature-canvas is currently mounting or unmounting: React refs are null during this phase.");const Z=(e,n)=>{const i=e.split(","),t=i[0].match(/:(.*?);/)[1],r=atob(i[1]);let a=r.length;const s=new Uint8Array(a);for(;a--;)s[a]=r.charCodeAt(a);return new File([s],n,{type:t})},tt=()=>{const e=R.useRef(null),n=O(r=>r.editFirma);return{sigCanvas:e,clearSignature:()=>{e.current.clear(),n(null)},saveSignature:()=>{const r=e.current.toDataURL("image/png"),a=Z(r,"firma.png");n(a),N.success("Firma guardada")}}},at=({view:e,formData:n})=>{var a,s;const{sigCanvas:i,clearSignature:t,saveSignature:r}=tt();return x.jsx("div",{className:"sm:col-span-6 md:col-span-2",children:e?x.jsxs(x.Fragment,{children:[x.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Imagen de la firma:"}),x.jsx("img",{className:"border-5 border-[#27548A] border-double w-full h-60",src:(a=n==null?void 0:n.documentos)==null?void 0:a.firma,alt:`Firma del tutor del jugador ${n==null?void 0:n.nombre} ${n==null?void 0:n.apellido_p} ${n==null?void 0:n.apellido_m}`})]}):x.jsxs(x.Fragment,{children:[((s=n==null?void 0:n.documentos)==null?void 0:s.firma)&&x.jsxs("a",{href:n.documentos.firma,target:"_blank",className:"text-md w-[max-content] ml-auto font-semibold text-gray-800 mb-2 flex items-center justify-end hover:text-gray-400 transition-all",children:["Ver firma actual",x.jsx($,{className:"h-4"})]}),x.jsx(S,{ref:i,canvasProps:{className:"border-5 border-[#27548A] border-double w-full h-60"}}),x.jsxs("div",{className:"flex mt-4 flex-col items-center gap-3 justify-center sm:flex-row sm:justify-around",children:[x.jsxs("button",{onClick:t,type:"button",className:"py-2 px-4 bg-primary rounded-sm text-white flex items-center gap-2 cursor-pointer hover:bg-primary-dark transition-all",children:[x.jsx(H,{})," Limpiar firma"]}),x.jsxs("button",{onClick:r,type:"button",className:"py-2 px-4 bg-[#1F7D53] rounded-sm text-white flex items-center gap-2 cursor-pointer hover:bg-[#255F38] transition-all",children:[x.jsx(q,{})," Guardar firma"]})]})]})})};export{at as S};
